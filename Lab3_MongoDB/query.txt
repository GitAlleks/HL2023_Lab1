db.rides.aggregate([{$group: {_id: "$driver_id",average_rating: { $avg: "$driver_rate" },trips: {$push: {client_id: "$client_id", start_point: "$start_point", end_point: "$end_point", distance: "$distance", start_time: "$start_time", end_time: "$end_time", road_time: "$road_time", cost: "$cost", driver_rate: "$driver_rate", client_rate: client_rate", category_driver_feedback: "$category_driver_feedback", text_driver_feedback: "$text_driver_feedback", category_client_feedback: "$category_client_feedback", text_client_feedback: "$text_client_feedback"}}}},{$match:{average_rating:{ $lt: 3.5 }}},{$project:{_id: 0, driver_id: "$_id", trips: 1}},{$out: "result_collection"}]);